version: '3.9'
services:
    IS-Postgres:
      image: postgres:latest
      volumes:
        - is-postgres-db-data:/var/lib/postgresql/isdata
      ports:
        - 5433:5432
      environment:
        POSTGRES_PASSWORD_FILE: /run/secrets/is_db_password
        POSTGRES_USER: user
      secrets:
        - is_db_password
    IS-User-Postgres:
      image: postgres:latest
      volumes:
        - is-user-postgres-db-data:/var/lib/postgresql/isuserdata
      ports:
        - 5434:5432
      environment:
        POSTGRES_PASSWORD_FILE: /run/secrets/is_user_db_password
        POSTGRES_USER: user
      secrets:
        - is_user_db_password
    TheGym-Postgres:
      image: postgres:latest
      volumes:
        - postgres-db-data:/var/lib/postgresql/data
      ports:
        - 5432:5432
      environment:
        POSTGRES_PASSWORD_FILE: /run/secrets/thegym_db_password
        POSTGRES_USER: user
      secrets:
        - thegym_db_password
secrets:
  is_db_password:
    file: ./Secrets/is_db_password.txt
  thegym_db_password:
    file: ./Secrets/thegym_db_password.txt
  is_user_db_password:
    file: ./Secrets/is_user_db_password.txt
volumes:
  is-postgres-db-data:
  is-user-postgres-db-data:
  postgres-db-data:
#use the env variable to move username and passwords to .env file
#or check out docker secrets but that may require the use of docker swarm 
#https://stackoverflow.com/questions/22651647/docker-and-securing-passwords